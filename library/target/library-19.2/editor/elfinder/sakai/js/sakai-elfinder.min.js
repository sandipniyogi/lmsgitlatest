(function(a){a.sakai={};a.sakai.elfinder={}})(jQuery);(function(a){a.sakai.elfinder.query=function(){var e={},d=window.location.search.slice(1).split("\x26");a.each(d,function(a,b){a=b.split("\x3d");e[a[0]]=a[1]});return e}})(jQuery);(function(a){a.sakai.tools=["Announcements","Attachments","Forums","Polls"]})(jQuery);
(function(a){var e=a.sakai.elfinder.ui=function(b){this.footer=function(){var b=a('\x3cdiv id\x3d"sakai-ui-footer"\x3e\x3c/div\x3e').addClass(d(c.confirmbar)),f=a("\x3cdiv\x3eOK\x3c/div\x3e").addClass(d(c.button,c.ok)),g=a("\x3cdiv\x3eCancel\x3c/div\x3e").addClass(d(c.button,c.cancel)),f=a("\x3cdiv\x3e\x3cdiv/\x3e").append(f,g).addClass(d(c.buttons));return b.append(f)};b.append(this.footer());b.find(c.statusbar).insertAfter(".elfinder-toolbar");b.find(".elfinder-stat-size, .elfinder-stat-selected").appendTo(c.confirmbar)},
d=e.toClass=function(){return a.makeArray(arguments).join(" ").replace(/\./g,"")},c=e.elements={};e.setSaveCloseButtons=function(b){var e=b.find(".ui-button").addClass(d(c.button));b=a(e[0]).addClass(d(c.cancel));var f=a(e[1]).addClass(d(c.ok)),e=a(e[2]).addClass(d(c.ok));f.insertAfter(e);b.insertAfter(f)};c.footer="#sakai-ui-footer";c.confirmbar="elfinder-confirm-bar";c.buttons=".buttons";c.button=".button";c.ok=".button-ok";c.cancel=".button-cancel";c.statusbar=".elfinder-statusbar";c.confirmbar=
".elfinder-confirm-bar"})(jQuery);(function(a){a.sakai.elfinder.resizer=function(a,d){d.resize(function(){var c=d.height()-2;a.height()!==c&&a.height(c).resize()})}})(jQuery);
(function(a){var e=a(window),d=a.sakai.elfinder.query(),c="/"+(d.connector||""),b=d.startdir,h=d.langCode;b&&(b=b.split("/"),b=b.filter(function(a){return a}),b=b.slice(1),b="/"+b.join("/"),b=btoa(b),b=b.replace("+","-").replace("/","_").replace("\x3d","."));var d=d.type,f=[];"image"==d?f=["image"]:"flash"==d&&(f=["application/x-shockwave-flash"]);var g=a.sakai.tools;a.sakai.elfinder.options={url:c,startPathHash:b,lang:h,defaultView:"list",getFileCallback:function(a){},onlyMimes:f,height:e.height(),
uiOptions:{toolbar:[["help",{type:"dialog",title:"Help",content:"example"}],["back","forward"],["reload"],["home","up"],["mkdir","upload"],["open","download","getfile"],["info"],["quicklook"],["copy","cut","paste"],["search"],["view"]],tree:{getClass:function(b){var c="";b.tool&&a.inArray(b.tool,g)&&(c="sakai-tool-"+b.tool.toLowerCase());return c}}},commandsOptions:{info:{custom:{}},edit:{editors:[]}},resizable:!1}})(jQuery);
(function(a){var e=a.sakai.elfinder.ui,d=function(){var b=!1,c,d=function(b){var d=c=CKEDITOR.replace(b.id,{startupFocus:!0,fullPage:!0,allowedContent:!0,removePlugins:"resize"}),g=a(b).closest(".elfinder-dialog");g.on("resize",function(a,b){b=g.find(".ui-dialog-content");a=b.height()-1;b=b.width();d.resize(b,a)})};return{mimes:["text/html"],load:function(c){var g=a(c).closest(".elfinder-dialog");e.setSaveCloseButtons(g);b?d(c):(a.getScript("//cdn.ckeditor.com/4.5.2/standard/ckeditor.js",function(){d(c)}),
b=!0)},close:function(a){},save:function(a){c&&(a.value=c.getData())},focus:function(a){}}}(),c=function(){var b=[],c,d=function(b,d){var e=a(b).closest(".elfinder-dialog"),f={lineNumbers:!0};d&&(f.mode=d);var g=c=CodeMirror.fromTextArea(b,f),h=e.find(".ui-dialog-content").addClass("elfinder-codemirror");b=function(){var a=h.width(),b=h.height();g.setSize(a,b)};e.on("resize",b);b()};return{load:function(c){var f=a(c).closest(".elfinder-dialog");e.setSaveCloseButtons(f);var g=this.file.mime,h=function(){var e=
CodeMirror.findModeByMIME(g).mode,f="/library/webjars/codemirror/5.41.0//mode/"+e+"/"+e+".js";"null"===e&&b.push(f);-1!==b.indexOf(f)?d(c,g):a.getScript("/library/webjars/codemirror/5.41.0//mode/"+e+"/"+e+".js").done(function(){b.push(f);d(c,g)}).fail(function(){console.log("Failed to load mode for "+e);d(c)})};-1===b.indexOf("/library/webjars/codemirror/5.41.0/lib/codemirror.js")?(a("head").append(a('\x3clink rel\x3d"stylesheet" href\x3d"/library/webjars/codemirror/5.41.0/lib/codemirror.css"\x3e')),
a.getScript("/library/webjars/codemirror/5.41.0/lib/codemirror.js",function(){b.push("/library/webjars/codemirror/5.41.0/lib/codemirror.js");a.getScript("/library/webjars/codemirror/5.41.0/mode/meta.js",h)})):h()},close:function(a){},save:function(a){c&&(a.value=c.getValue())},focus:function(a){}}}();a.sakai.elfinder.options.commandsOptions.edit.editors=[d,c]})(jQuery);
(function(a){var e=a.sakai.elfinder.ui.elements;a.sakai.elfinder.options.handlers={open:function(c,b){a(e.footer).data("cwd",c.data.options.url)},select:function(c,b){var d=c.data.selected;c=a(e.footer);d.length?(c.data("embed",b.file(d[0]).url),b.exec("getfile",d)):(b=c.data("cwd"),c.data("embed",b))}};var d;a(document).keydown(function(a){d=13==a.which}).click(function(){d=!1});a.sakai.elfinder.options.getFileCallback=function(c,b){b.options.commandsOptions.getfile={folders:!1};b=a(e.footer);b.data("embed",
c.url);b.data("file",c);d&&a(e.footer).find(e.ok).click()};a.sakai.elfinder.confirm=function(c){var b=c.find(e.footer),d=a.sakai.elfinder.query().CKEditorFuncNum;b.on("click",".button-ok",function(a){a=b.data("embed");window.opener.CKEDITOR.tools.callFunction(d,a);window.close()});b.on("click",".button-cancel",function(a){window.close()})}})(jQuery);(function(a){elFinder.prototype.i18.en.messages.kind="Type"})(jQuery);
(function(a,e){a(function(){var d=a.sakai.elfinder.options,c=a.sakai.elfinder.ui,b=a.sakai.elfinder.resizer,h=a.sakai.elfinder.confirm,f=a("#elfinder"),g=a(e);f.elfinder(d);b(f,g);c(f);h(f)})})(jQuery,window);